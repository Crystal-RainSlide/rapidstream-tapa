From 19dc522b4d72f51d53643c8644261978fe59983b Mon Sep 17 00:00:00 2001
From: Jason Lau <lau@rapidstream-da.com>
Date: Mon, 19 Aug 2024 22:17:40 -0700
Subject: [PATCH] build: disable zlib, mpfr and terminfo

---
 libc/BUILD.bazel | 2 +-
 llvm/BUILD.bazel | 9 ---------
 2 files changed, 1 insertion(+), 10 deletions(-)

diff --git a/libc/BUILD.bazel b/libc/BUILD.bazel
index 7f65a93e9..4fd268491 100644
--- a/libc/BUILD.bazel
+++ b/libc/BUILD.bazel
@@ -25,7 +25,7 @@ licenses(["notice"])
 # Flag documentation: https://bazel.build/extending/config
 string_flag(
     name = "mpfr",
-    build_setting_default = "external",
+    build_setting_default = "disable",
     values = [
         "disable",  # Skip tests that need mpfr
         "external",  # Build mpfr from source
diff --git a/llvm/BUILD.bazel b/llvm/BUILD.bazel
index b01f04748..5a5ee2ece 100644
--- a/llvm/BUILD.bazel
+++ b/llvm/BUILD.bazel
@@ -273,15 +273,6 @@ cc_library(
     deps = [
         ":config",
         ":Demangle",
-        # We unconditionally depend on the custom LLVM terminfo wrapper. This
-        # will be an empty library unless terminfo is enabled, in which case it
-        # will both provide the necessary dependencies and configuration
-        # defines.
-        "@llvm_terminfo//:terminfo",
-        # We unconditionally depend on the custom LLVM zlib wrapper. This will
-        # be an empty library unless zlib is enabled, in which case it will
-        # both provide the necessary dependencies and configuration defines.
-        "@llvm_zlib//:zlib",
     ],
 )

-- 

